#!/bin/bash

if [ "$1" != "fast" ]; then
    rm -rf jspm_packages node_modules
fi

source ./script/bootstrap || exit 1

>&2 echo "==> Installing node packages"
npm install --silent || exit 2

if [[ ${JSPM_GITHUB_AUTH_TOKEN} ]]; then
  >&2 echo "==> Configuring jspm to use the GitHub Auth token to download packages from GitHub"
  $(npm bin)/jspm --log error config registries.github.auth ${JSPM_GITHUB_AUTH_TOKEN}
fi

>&2 echo "==> Installing JSPM packages"
$(npm bin)/jspm --log error install || exit 3
